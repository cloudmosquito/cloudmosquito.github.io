# 能控性与能观性

有些著作会说“可控性”“可观性”，表达的是同一个意思。英文对应 “Controllability” "Observability"。笔者本科阶段修读《现代控制理论》时，老师采用的说法是“能控性”“能观性”，本篇因而沿用这一表述。

## 定义

下文称“系统”，指的是如下线性定常 MIMO 系统：

$$\begin{aligned}
\dot{\mathbf{x}} &= A\mathbf{x} + B\mathbf{u}\\
\mathbf{y} &= C\mathbf{x} + D\mathbf{u}
\end{aligned}$$

其中 $\mathbf{x}\in \mathbb{R}^n$ 是状态变量， $\mathbf{u}\in\mathbb{R}^n$ 是控制输入， $\mathbf{y}\in\mathbb{R}^n$ 是系统输出。 $A,B,C,D \in \mathbb{R}^{n\times n}$ 是定常的参数矩阵，其中 $A$ 被称为系统矩阵， $B$ 被称为控制矩阵。

**能控性** 指的是对于任意初始时刻 $t_0$ 和任意初始系统状态 $\mathbf{x}_0$ ，我们总能选取一个控制输入 $\mathbf{u}$ 使得系统状态 $\mathbf{x}$ 在有限时间里运动到任意期望状态 $\mathbf{x}_f$ 。

> 能控性的定义，不要求系统具体用多少时间达到期望状态，也不要求系统状态沿怎样一个路径变化。

**能观性** 指的是已知一个时间段内系统输出 $\mathbf{y}(t)$ 和控制输入 $\mathbf{u}(t)$ ，我们即可确定系统状态初值 $\mathbf{x}_0$ ，继而可以确定系统在该时间段内任意时刻对应的状态。

## 能控性

> 仅考虑离散系统。连续系统的推导思路类似。

考虑初始状态 $\mathbf{x}_0$ ，N 时刻的最终状态 $\mathbf{x}_{N}$ ，有

$$\begin{aligned}
\mathbf{x}_N &= A\mathbf{x}_{N-1}+B\mathbf{u}_{N-1}\\
&= A(A\mathbf{x}_{N-2}+B\mathbf{u}_{N-2})+B\mathbf{u}_{N-1}\\
&= \cdots\\
&= A^{N}\mathbf{x}_0+A^{N-1}B\mathbf{u}_0 + A^{N-2}B\mathbf{u}_{1} + \cdots+B\mathbf{u}_{N-1}\\
&= \begin{bmatrix}B & AB & A^2B & \cdots & A^{N-1}B\end{bmatrix}\begin{bmatrix}\mathbf{u}_{N-1}\\\mathbf{u}_{N-2}\\ \vdots\\\mathbf{u}_0\end{bmatrix}+A^{N}\mathbf{x}_0\\
\implies &\begin{bmatrix}B & AB & A^2B & \cdots & A^{N-1}B\end{bmatrix}\begin{bmatrix}\mathbf{u}_{N-1}\\\mathbf{u}_{N-2}\\ \vdots\\\mathbf{u}_0\end{bmatrix} = \mathbf{x}_N - A^{N}\mathbf{x}_0
\end{aligned}$$

令矩阵 $G = \begin{bmatrix}B & AB & A^2B & \dots & A^{N-1}B\end{bmatrix}$ ，则可知 $G$ 的尺寸为 $n\times mN$ ，一般情况下 $mN>n$ ，这是一个欠定的线性方程组。

!!! theorem "线性方程组解的定理"

    设 $G$ 和 $\bar{G}$ 分别为线性方程组的系数矩阵和增广矩阵，则

    线性方程组有解等价于 $\mathrm{rank}(G) = \mathrm{rank}(\bar{G})$ ；

    线性方程组无解等价于 $\mathrm{rank}(G) < \mathrm{rank}(\bar{G})$ .

    当线性方程组有解时，若 $\mathrm{rank}(G)$ 等于未知量个数，则有唯一解；

    若 $\mathrm{rank}(G)$ 小于未知量个数，则有无穷多解。

系统 $(A,B)$ 能控 $\Longleftrightarrow$ 对于任意 $\mathbf{x}_N$ ，该线性方程组有解。

因为 $\mathbf{x}_N$ 可以任意取，所以增广矩阵 $\bar{G}$ 必定存在行满秩的情况，要使此时的线性方程组也有解，则系数矩阵 $G$ 必须是行满秩的。所以，系统 $(A,B)$ 能控 $\Longleftrightarrow \mathrm{rank}(G) = n$ .

更进一步，根据 [Hamilton-Caley](../../数学/高等代数/Hamilton-Cayley%20定理.md) 定理的推论，$A^k,k\ge n$ 可以表示为 $A^i, i<n$ 的线性组合。所以，$\mathrm{rank}(G) = n \Longleftrightarrow \mathrm{rank}\begin{bmatrix}B & AB & A^2B & \cdots & A^{n-1}B\end{bmatrix} = n$ .

> 对于 LTV 线性时变系统，无法做此简化，只能把 N 项的 $(A_j,B_j)$ 都算出来，然后判断矩阵 $G$ 是否行满秩。

我们称矩阵 $Q_c =\begin{bmatrix}B & AB & A^2B & \cdots & A^{n-1}B\end{bmatrix}$ 为 **能控性矩阵** 。系统 $(A,B)$ 能控 $\Longleftrightarrow$ 能控性矩阵行满秩。

## 能观性

见 “观测器” 中的 [系统能观性](../观测器/系统能观性.md) 一文。
