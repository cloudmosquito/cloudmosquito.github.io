# 刚性运动和齐次变换

## 参考书目

《机器人建模与控制》[美] Mark W. Spong, Seth Hutchinson, M. Vidyasager

## 1 旋转矩阵

$$ _1^0 R = \begin{bmatrix}
  x_0 \cdot x_1 & x_0 \cdot y_1 & x_0 \cdot z_1 \\
  y_0 \cdot x_1 & y_0 \cdot y_1 & y_0 \cdot z_1 \\
  z_0 \cdot x_1 & z_o \cdot y_1 & z_0 \cdot z_1
\end{bmatrix}$$

这里的$x_0, y_0, z_0$是坐标系0的三个单位向量，$x_1, y_1, z_1$是坐标系1的三个单位向量。要求，坐标系0和坐标系1的**原点是重合的**。

矩阵既表示三维坐标系$o_1x_1y_1z_1$相对于参考系$o_0x_0y_0z_0$的姿态角，也描述了从三维坐标系1到三维坐标系0的旋转坐标变换。
**此外，还可以看作在固定坐标系0中的一个旋转操作符！！！**。
（我在做习题4.13中误认为$_0^1R$是这个旋转操作符）

对于一个隶属于坐标系1的向量$^1 A = \begin{bmatrix} ^1x_{a} \\ ^1y_{a} \\ ^1z_{a} \end{bmatrix}$，可以用$_1^0 R \cdot ^1A$的方式计算该向量在坐标系0下的表示方式$^0A$。

**理解**：$_1^0 R \cdot ^1A$的第一行是将$^1x_{a}, ^1y_{a}, ^1z_{a}$投影到$x_0$的部分求和，第二行是将$^1x_{a}, ^1y_{a}, ^1z_{a}$投影到$y_0$的部分求和，第三行是将$^1x_{a}, ^1y_{a}, ^1z_{a}$投影到$z_0$的部分求和。

**性质**：

1. $(_1^0 R)^T = (_1^0 R)^{-1} = (_0^1 R)$。（评：符合直觉）
2. ~（补充上一条）~旋转矩阵是一个正交矩阵。（正交矩阵：每个列向量具有单位长度并且相互垂直）
3. $_1^0 R$的每行每列都是一个单位向量。（评：第一行就是$x_0$在坐标系1的表示，第一列就是$x_1$在坐标系0的表示）

**基本旋转矩阵**：

$$ R_{z, \theta} = \begin{bmatrix}
  \cos\theta & -\sin \theta & 0 \\
  \sin \theta & \cos \theta & 0 \\
  0 & 0 & 1
\end{bmatrix}$$

$$ R_{x, \theta} = \begin{bmatrix}
  1 & 0 & 0 \\
  0 & \cos \theta & -\sin\theta \\
  0 & \sin\theta & \cos\theta
\end{bmatrix} $$

$$ R_{y, \theta} = \begin{bmatrix}
  \cos\theta & 0 & \sin\theta \\
  0 & 1 & 0 \\
  -\sin\theta & 0 & \cos\theta
\end{bmatrix}$$

**一般化**：

$$ R_{k, \theta} = \begin{bmatrix}
k_x^2v_{\theta}+c_{\theta} & k_xk_yv_{\theta}-k_zs_{\theta} & k_xk_zv_{\theta}+k_ys_{\theta}\\ k_xk_yv_{\theta}+k_zs_{\theta} & k_y^2v_{\theta}+c_{\theta} & k_yk_zv_{\theta}-k_xs_{\theta}\\ k_xk_zv_{\theta}-k_ys_{\theta} & k_yk_zv_{\theta}+k_xs_{\theta} & k_z^2v_{\theta}+c_{\theta}
\end{bmatrix} $$

其中，$v_{\theta} = vers(\theta) = 1 - c_{\theta}$，$k$是单位向量$\begin{bmatrix}k_x & k_y & k_z\end{bmatrix}^T$

若已知一个等轴角表示的旋转矩阵：

$$R_{\mathbf{k}, \theta} = \begin{bmatrix}
r_{11} & r_{12} & r_{13}\\
r_{21} & r_{22} & r_{23}\\
r_{31} & r_{32} & r_{33}
\end{bmatrix}$$

则有

$$\theta = \arccos \frac{r_{11} + r_{22} + r_{33} - 1}{2}$$

$$\mathbf{k} = \frac{1}{2\sin\theta}\begin{bmatrix}r_{32} - r_{23}\\ r_{13} - r_{31}\\ r_{21} - r_{12}\end{bmatrix}$$

## 2 相似变换

如果A描述了一个给定线性变换在坐标系1中的表示，B描述了一个给定线性变换在坐标系0中的表示，则有：

$$ B = (_1^0R) A (_0^1R) $$

**理解**：以$(^0\zeta) = B \cdot (^0\alpha) = (_1^0R) A (_0^1R)\cdot (^1\alpha)$为例

1. $\beta = (_0^1R)\cdot (^1\alpha)$：将$^0\alpha$向量转换到坐标系1内，得到$^1\beta$向量。
2. $\gamma = A \cdot \beta$：对$^1\beta$作线性变换A，得到$^1\gamma$向量。
3. $(^0\zeta) = B \cdot (^0\alpha) = (_1^0R)\cdot \gamma$：将$^1\gamma$向量转换回坐标系0，得到$^0\zeta$向量。

## 3 任意旋转的最小参数化

四个参数就足以描述一个三维旋转：旋转轴和旋转角度。

还有一种方式：四元数。

### 3.1 欧拉角

欧拉角就是规定旋转顺序，一共转三次，每次都绕着新的机体坐标系旋转，来表示一个总旋转。

一般来说，我们规定绕 $X$ 轴旋转的角度为 $\phi$，绕 $Y$ 轴旋转的角度为 $\theta$，绕 $Z$ 轴旋转的角度为 $\psi$ .

我们给出一些结论：

$$R_{XYZ} = \begin{bmatrix}
c\theta c\psi & -c\theta s\psi & s\theta \\
s\phi s\theta c\psi + c\phi s\psi & -s\phi s\theta s\psi + c\phi c\psi & -s\phi c\theta \\
-c\phi s\theta c\psi + s\phi s\psi & c\phi s\psi s\theta + s\phi c\phi & c\phi c\theta
\end{bmatrix}$$

$$R_{ZYX} = \begin{bmatrix}
c\psi c\theta & -s\psi c\phi + c\psi s\theta s\phi & s\psi s\phi + c\psi s\theta c\phi\\
s\psi s\theta & c\psi c\phi + s\psi s\theta s\phi & -c\psi s\phi + s\psi s\theta c\phi\\
-s\theta & c\theta s\phi & -c\theta c\phi
\end{bmatrix}$$

## 4 齐次变换

齐次变换利用 SE(3) 中的矩阵来描述刚性运动：平移和旋转。

$$
T = \begin{bmatrix} \mathbf{R}_{3\times 3} & \mathbf{t}_{3\times 1}\\ \mathbf{0}^T & 1 \end{bmatrix}
$$

其中，$\mathbf{R} \in \mathrm{SO}(3)$ 是一个旋转矩阵，$\mathbf{t} \in \mathbb{R}^3$ 是一个平移向量。
