
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Cloudmosquito's Lib">
      
      
        <meta name="author" content="Cloudmosquito">
      
      
      
        <link rel="prev" href="../%E5%9B%9B%E6%97%8B%E7%BF%BC%20SO%283%29%20%E5%A7%BF%E6%80%81%E6%8E%A7%E5%88%B6/">
      
      
        <link rel="next" href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/ROS2%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>四旋翼微分平坦与最小 snap 轨迹 - Cloudmosquito Site</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#snap" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Cloudmosquito Site" class="md-header__button md-logo" aria-label="Cloudmosquito Site" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cloudmosquito Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              四旋翼微分平坦与最小 snap 轨迹
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  WELCOME

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/" class="md-tabs__link">
          
  
  
    
  
  控制理论

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%95%B0%E5%AD%A6/%E7%9F%A9%E9%98%B5%E5%BE%AE%E7%A7%AF%E5%88%86/" class="md-tabs__link">
          
  
  
    
  
  数学

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%96%87%E5%AD%A6/" class="md-tabs__link">
          
  
  
    
  
  文学

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  机器人&飞机

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/ROS2%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" class="md-tabs__link">
          
  
  
    
  
  杂学旁收

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Cloudmosquito Site" class="md-nav__button md-logo" aria-label="Cloudmosquito Site" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cloudmosquito Site
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WELCOME
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    控制理论
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            控制理论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/Lyapunov%20%E7%A8%B3%E5%AE%9A%E6%80%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lyapunov 稳定性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    《非线性控制》笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            《非线性控制》笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E3%80%8A%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%8E%A7%E5%88%B6%E3%80%8B%E7%AC%94%E8%AE%B0/1%20%E5%BC%95%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一、引论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E3%80%8A%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%8E%A7%E5%88%B6%E3%80%8B%E7%AC%94%E8%AE%B0/%E5%B9%B3%E8%A1%A1%E7%82%B9%E7%9A%84%E7%A8%B3%E5%AE%9A%E6%80%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    平衡点的稳定性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E3%80%8A%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%8E%A7%E5%88%B6%E3%80%8B%E7%AC%94%E8%AE%B0/%E7%89%B9%E6%AE%8A%E5%9E%8B%E9%9D%9E%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    特殊型非线性系统
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    滤波器
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            滤波器
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E6%BB%A4%E6%B3%A2%E5%99%A8/IIR%20%E4%B8%8E%20FIR%20%E6%BB%A4%E6%B3%A2%E5%99%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IIR 与 FIR 滤波器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E6%BB%A4%E6%B3%A2%E5%99%A8/%E4%B8%80%E9%98%B6%E6%83%AF%E6%80%A7%E6%BB%A4%E6%B3%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一阶惯性滤波
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E6%BB%A4%E6%B3%A2%E5%99%A8/%E9%99%B7%E6%B3%A2%E5%99%A8%E8%AF%B4%E6%98%8E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    陷波器说明
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    自动控制原理
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            自动控制原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86/%E6%8B%89%E6%B0%8F%E5%8F%98%E6%8D%A2%E5%88%9D%E7%BB%88%E5%80%BC%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Laplace变换初/终值定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86/%E8%83%BD%E6%8E%A7%E6%80%A7%E5%92%8C%E8%83%BD%E8%A7%82%E6%80%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    能控性与能观性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_3" >
        
          
          <label class="md-nav__link" for="__nav_2_5_3" id="__nav_2_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PID 相关
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            PID 相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86/PID%20%E7%9B%B8%E5%85%B3/%E4%BA%91%E5%8F%B0%20PID%20%E7%90%86%E8%AE%BA%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    云台 PID 控制理论分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E8%87%AA%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86/PID%20%E7%9B%B8%E5%85%B3/%E7%B3%BB%E7%BB%9F%E9%98%B6%E6%95%B0%E4%B8%8E%20PID/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    系统阶数与 PID
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    观测器
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            观测器
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%8E%A7%E5%88%B6%E7%90%86%E8%AE%BA/%E8%A7%82%E6%B5%8B%E5%99%A8/%E5%BC%95%E8%A8%80%EF%BC%88%E7%B3%BB%E7%BB%9F%E8%83%BD%E8%A7%82%E6%80%A7%EF%BC%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    引言（系统能观性）
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数学
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E5%AD%A6/%E7%9F%A9%E9%98%B5%E5%BE%AE%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    矩阵微积分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    高等代数
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            高等代数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E5%AD%A6/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/Hamilton-Cayley%20%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    哈密顿-凯莱定理（Hamilton-Cayley theorem）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E5%AD%A6/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/Jordan%20%E6%A0%87%E5%87%86%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jordan 标准型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E5%AD%A6/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/%E4%BA%8C%E6%AC%A1%E5%9E%8B%E4%B8%8E%28%E5%8D%8A%29%E6%AD%A3%E8%B4%9F%E5%AE%9A%E6%80%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二次型与（半）正负定性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%95%B0%E5%AD%A6/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/%E7%9F%A9%E9%98%B5%E5%AF%B9%E8%A7%92%E5%8C%96%E4%B8%8E%E5%88%86%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    矩阵对角化与分解
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E6%96%87%E5%AD%A6/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    文学
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            文学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    小说创作
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            小说创作
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%96%87%E5%AD%A6/%E5%B0%8F%E8%AF%B4%E5%88%9B%E4%BD%9C/%E5%92%AB%E5%B0%BA%E5%A4%A9%E6%B6%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    咫尺天涯
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    阅读笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            阅读笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3_1" >
        
          
          <label class="md-nav__link" for="__nav_4_3_1" id="__nav_4_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    《中国叙事学》
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_1">
            <span class="md-nav__icon md-icon"></span>
            《中国叙事学》
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%96%87%E5%AD%A6/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/%E3%80%8A%E4%B8%AD%E5%9B%BD%E5%8F%99%E4%BA%8B%E5%AD%A6%E3%80%8B/%E3%80%8A%E4%B8%AD%E5%9B%BD%E5%8F%99%E4%BA%8B%E5%AD%A6%E3%80%8B%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    绪论笔记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    机器人&飞机
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            机器人&飞机
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    机器人学
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            机器人学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%AD%A6/%E5%A7%BF%E6%80%81%E8%A1%A8%E7%A4%BA%E7%9A%84%E5%AF%BC%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    姿态表示的导数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%AD%A6/%E6%97%8B%E8%BD%AC%E4%B8%8E%E5%A7%BF%E6%80%81%E7%9A%84%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    旋转与姿态的表示
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%AD%A6/%E6%9D%8E%E7%BE%A4%E4%B8%8E%E6%9D%8E%E4%BB%A3%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    李群与李代数
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" checked>
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    论文阅读
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            论文阅读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%9B%9B%E6%97%8B%E7%BF%BC%20SO%283%29%20%E5%A7%BF%E6%80%81%E6%8E%A7%E5%88%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    四旋翼 SO(3) 姿态控制
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    四旋翼微分平坦与最小 snap 轨迹
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    四旋翼微分平坦与最小 snap 轨迹
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0" class="md-nav__link">
    <span class="md-ellipsis">
      0 论文与前言
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1 微分平坦
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2 四旋翼模型
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3 四旋翼模型的微分平坦性证明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 四旋翼模型的微分平坦性证明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-6" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 位置和线速度（6 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-4" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 推力与姿态（4 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-3" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 角速度（3 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-3" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 三轴力矩（3 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 小结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4 控制器设计
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 控制器设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 推力
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 力矩
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 螺旋桨转速
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 控制器稳定性、收敛性分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5 轨迹生成
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5 轨迹生成">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 限制条件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 基于微分平坦定义轨迹优化问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-nondimensionalization" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 无量纲化 nondimensionalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-corridor-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 通道限制 corridor constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-optimal-segment-times" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 最佳时间分割（Optimal segment times）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    杂学旁收
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            杂学旁收
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/ROS2%20%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ROS2 学习记录
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/git%20%E7%94%A8%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    git 相关操作
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人网站搭建指南
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/%E5%A4%A9%E7%A9%BA%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E8%93%9D%E8%89%B2%E7%9A%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    天空为什么是蓝色的？
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LInux (Ubuntu) 使用 Tips
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            LInux (Ubuntu) 使用 Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/terminator%20%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    terminator 快捷键
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8D%B8%E8%BD%BD%E8%BD%AF%E4%BB%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    安装与卸载软件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E5%92%8C%20windows%20%E5%8F%8C%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E4%B8%80%E8%87%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么设置双系统时间一致
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E6%8D%A2%E6%BA%90%20pip%20install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么换源 pip install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E6%96%B0%E5%BB%BA%E6%88%96%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%EF%BC%88%E5%A4%B9%EF%BC%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么新建或删除文件（夹）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E7%9C%8B%E7%A1%AC%E7%9B%98%E5%89%A9%E4%BD%99%E7%A9%BA%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么看硬盘剩余空间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3%E5%85%B3%E6%9C%BA%E4%B8%BB%E6%9D%BF%E4%B8%8D%E6%96%AD%E7%94%B5%E7%9A%84%E9%97%AE%E9%A2%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么解决 Ubuntu 关机后电脑主板不断电
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E8%AE%BE%E7%BD%AE%20sudo%20%E4%B8%8D%E7%94%A8%E5%AF%86%E7%A0%81/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么设置 sudo 不用密码
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%9D%82%E5%AD%A6%E6%97%81%E6%94%B6/LInux%20%28Ubuntu%29%20%E4%BD%BF%E7%94%A8%20Tips/%E6%80%8E%E4%B9%88%E9%A6%96%E9%80%89%E5%90%AF%E7%94%A8%20Nvidia%20%E6%98%BE%E5%8D%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    怎么首选启用 Nvdia 显卡
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0" class="md-nav__link">
    <span class="md-ellipsis">
      0 论文与前言
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1 微分平坦
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2 四旋翼模型
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3 四旋翼模型的微分平坦性证明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 四旋翼模型的微分平坦性证明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-6" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 位置和线速度（6 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-4" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 推力与姿态（4 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-3" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 角速度（3 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-3" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 三轴力矩（3 个量）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 小结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4 控制器设计
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 控制器设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 推力
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 力矩
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 螺旋桨转速
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 控制器稳定性、收敛性分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5 轨迹生成
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5 轨迹生成">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 限制条件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 基于微分平坦定义轨迹优化问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-nondimensionalization" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 无量纲化 nondimensionalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-corridor-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 通道限制 corridor constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-optimal-segment-times" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 最佳时间分割（Optimal segment times）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="snap">四旋翼微分平坦与最小 snap 轨迹</h1>
<h2 id="0">0 论文与前言</h2>
<p>本次阅读的论文为：<a href="../%E5%9B%9B%E6%97%8B%E7%BF%BC%E5%BE%AE%E5%88%86%E5%B9%B3%E5%9D%A6%E4%B8%8E%E6%9C%80%E5%B0%8F%20snap%20%E8%BD%A8%E8%BF%B9.assets/%E8%AE%BA%E6%96%87.pdf">D. Mellinger and V. Kumar, "Minimum snap trajectory generation and control for quadrotors," 2011 IEEE International Conference on Robotics and Automation, Shanghai, China, 2011, pp. 2520-2525.</a></p>
<p>这篇论文是四旋翼无人机微分平坦以及 Minimun Snap 轨迹生成的开山之作。但是论文之中也有些错误或者不详尽之处，本文会按照自己的思路加以补充。</p>
<hr />
<h2 id="1">1 微分平坦</h2>
<p>一个系统是微分平坦的，指可以选取一组系统输出量，使用该输出量及其有限阶导数，可以完整表示系统所有状态变量和输入变量。</p>
<h2 id="2">2 四旋翼模型</h2>
<p>规定三个坐标系，一个世界坐标系 <span class="arithmatex">\(\{\mathcal{W}\}\)</span>，一个机体坐标系 <span class="arithmatex">\(\{\mathcal{B}\}\)</span>，四个中间过渡用的坐标系： <span class="arithmatex">\(\{\mathcal{W}'\}\)</span>，<span class="arithmatex">\(\{\mathcal{C}_1\}\)</span> 和 <span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 以及 <span class="arithmatex">\(\{\mathcal{D}\}\)</span>.</p>
<p>用 <span class="arithmatex">\(^WR_B\)</span> 表示从 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 坐标系到 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 坐标系的旋转矩阵。如果一个变量没有在左上角指明坐标系，那就默认是在 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 坐标系下。</p>
<p>我们用 Z-X-Y 欧拉角表示四旋翼机体姿态，绕 Z-X-Y 旋转的角度分别定义为 <span class="arithmatex">\(\psi, \phi, \theta\)</span>，规定它们的取值范围是 <span class="arithmatex">\([-\pi, \pi)\)</span> 。</p>
<p>坐标系 <span class="arithmatex">\(\{\mathcal{W}'\}\)</span> 是坐标系 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 平移到机体坐标系 <span class="arithmatex">\(\{B\}\)</span> 使得两原点重合的结果。
坐标系 <span class="arithmatex">\(\{\mathcal{C_1}\}\)</span> 是 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 绕 yaw 轴（<span class="arithmatex">\(\mathbf{z}_\mathcal{W}\)</span>）旋转了 <span class="arithmatex">\(\psi\)</span> 角度。坐标系 <span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 是坐标系 <span class="arithmatex">\(\{\mathcal{C}_1\}\)</span> 平移到机体坐标系 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 使得两原点重合的结果。坐标系 <span class="arithmatex">\(\{\mathcal{D}\}\)</span> 是坐标系 <span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 绕 roll 轴（<span class="arithmatex">\(\mathbf{x}_{\mathcal{C}_2}\)</span>）旋转了 <span class="arithmatex">\(\phi\)</span> 角度，坐标系 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 是坐标系 <span class="arithmatex">\(\{\mathcal{D}\}\)</span> 绕 pitch 轴（<span class="arithmatex">\(\mathbf{y}_{\mathcal{D}}\)</span>）旋转了 <span class="arithmatex">\(\theta\)</span> 角度。</p>
<p><a class="glightbox" href="../%E5%9B%9B%E6%97%8B%E7%BF%BC%E5%BE%AE%E5%88%86%E5%B9%B3%E5%9D%A6%E4%B8%8E%E6%9C%80%E5%B0%8F%20snap%20%E8%BD%A8%E8%BF%B9.assets/%E5%9D%90%E6%A0%87%E7%B3%BB.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="坐标系示意图" src="../%E5%9B%9B%E6%97%8B%E7%BF%BC%E5%BE%AE%E5%88%86%E5%B9%B3%E5%9D%A6%E4%B8%8E%E6%9C%80%E5%B0%8F%20snap%20%E8%BD%A8%E8%BF%B9.assets/%E5%9D%90%E6%A0%87%E7%B3%BB.png" width="100%" /></a></p>
<div class="arithmatex">\[\begin{aligned}\mathcal{W} &amp; \overset{Translation}\Longleftrightarrow \mathcal{W}'\\
\mathcal{C}_1 &amp;\overset{Translation}\Longleftrightarrow \mathcal{C}_2\\
\mathcal{W}' \overset{Rotate \ \psi}\Longrightarrow \mathcal{C}_2 &amp; \overset{Rotate \ \phi}\Longrightarrow \mathcal{D} \overset{Rotate \ \theta}\Longrightarrow \mathcal{B}
\end{aligned}
\]</div>
<blockquote>
<p>【注意】论文原文仅给出了 <span class="arithmatex">\(\{\mathcal{W}\}\)</span>，<span class="arithmatex">\(\{\mathcal{C}\}\)</span> 和 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 三个坐标系，但为了下文讨论的精确性和严谨性，我们需要定义上述所有坐标系。</p>
</blockquote>
<p>由于仅发生平移，所以从坐标系 <span class="arithmatex">\(\{\mathcal{C}_1\}\)</span> 或坐标系 <span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 到 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 的旋转矩阵均为 <span class="arithmatex">\(^WR_C\)</span>，从坐标系 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 到坐标系 <span class="arithmatex">\(\{\mathcal{C}_1\}\)</span> 或 <span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 的旋转矩阵均为 <span class="arithmatex">\(^CR_B\)</span> ，从坐标系 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 到坐标系 <span class="arithmatex">\(\{\mathcal{W}'\}\)</span> 或 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 的旋转矩阵为 <span class="arithmatex">\(^WR_B\)</span> 。</p>
<p>在 <span class="arithmatex">\(\{\mathcal{W}\}\)</span> 坐标系下， <span class="arithmatex">\(\{\mathcal{C}_1\}\)</span> 坐标系的角速度向量与在 <span class="arithmatex">\(\{\mathcal{W}'\}\)</span> 坐标系下，<span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 坐标系的角速度向量是相同的，统一用 <span class="arithmatex">\(\omega_{\mathcal{CW}}\)</span> 表示。</p>
<p>在 <span class="arithmatex">\(\{\mathcal{W}'\}\)</span> 坐标系下，四旋翼机体 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 的角速度向量用 <span class="arithmatex">\(\omega_{\mathcal{BW}}\)</span> 表示 。以<span class="arithmatex">\(\mathbf{x}_B, \mathbf{y}_B, \mathbf{z}_B\)</span>作为一组基，定义其三轴分量分别为 <span class="arithmatex">\(p, q, r\)</span>。</p>
<div class="arithmatex">\[\begin{aligned}
\omega_{\mathcal{BW}} &amp;= p \mathbf{x}_{B} +q\mathbf{y}_{B} + r\mathbf{z}_{B}\\
\end{aligned} \tag{1}\]</div>
<p>在 <span class="arithmatex">\(\{\mathcal{W}'\}\)</span> 系下：坐标系 <span class="arithmatex">\(\{\mathcal{D}\}\)</span> 相对于坐标系 <span class="arithmatex">\(\{\mathcal{C}_2\}\)</span> 角速度向量用  <span class="arithmatex">\(\omega_{\mathcal{DC}_2}\)</span> 表示；四旋翼机体 <span class="arithmatex">\(\{\mathcal{B}\}\)</span> 相对于坐标系 <span class="arithmatex">\(\{\mathcal{D}\}\)</span> 的角速度向量用 <span class="arithmatex">\(\omega_{\mathcal{BD}}\)</span> 表示。从而有</p>
<div class="arithmatex">\[\begin{aligned}
\omega_{\mathcal{BW}} &amp;=\omega_{\mathcal{BD}} + \omega_{\mathcal{DC}_2} + \omega_{\mathcal{C}\mathcal{W}}\\
&amp;=\begin{bmatrix}\mathbf{x}_D &amp; \mathbf{y}_D &amp; \mathbf{z}_D\end{bmatrix}\begin{bmatrix}0 \\ \dot{\theta} \\ 0\end{bmatrix} + \begin{bmatrix}\mathbf{x}_{C_2} &amp; \mathbf{y}_{C_2} &amp; \mathbf{z}_{C_2}\end{bmatrix}\begin{bmatrix}\dot{\phi} \\ 0 \\ 0\end{bmatrix} + \begin{bmatrix}\mathbf{x}_{W'} &amp; \mathbf{y}_{W'} &amp; \mathbf{z}_{W'}\end{bmatrix}\begin{bmatrix}0 \\ 0 \\ \dot\psi\end{bmatrix}\\
&amp;= \dot{\theta}\mathbf{y}_{D} + \dot\phi\mathbf{x}_{C_2} + \dot{\psi}\mathbf{z}_{W'}
\end{aligned} \tag{2}\]</div>
<p>四旋翼的四个螺旋桨转速分别定义为 <span class="arithmatex">\(\omega_1,\omega_2,\omega_3,\omega_4\)</span>，则其提供的升力</p>
<div class="arithmatex">\[F_i = k_F\omega_i^2, M_i = k_M\omega_i^2\]</div>
<p>从而我们可以定义一个输入量 <span class="arithmatex">\(\mathbf{u}\)</span></p>
<div class="arithmatex">\[
\mathbf{u} = \begin{bmatrix}F\\ M_x\\ M_y\\ M_z\end{bmatrix} = \begin{bmatrix}k_F &amp; k_F &amp; k_F &amp; k_F\\
0 &amp; k_FL &amp; 0 &amp; -k_FL\\
-k_FL &amp; 0 &amp; k_FL &amp; 0\\
k_M &amp; -k_M &amp; k_M &amp; -k_M\end{bmatrix}\begin{bmatrix}\omega_1^2\\ \omega_2^2\\ \omega_3^2\\ \omega_4^2\end{bmatrix}\tag{3}
\]</div>
<p>逆变换如下：</p>
<div class="arithmatex">\[
\begin{bmatrix}\omega_1^2\\ \omega_2^2\\\omega_3^2\\ \omega_4^2\end{bmatrix} = \begin{bmatrix}\frac{1}{4k_F} &amp; 0 &amp; -\frac{1}{2k_FL} &amp; \frac{1}{4k_M}\\
\frac{1}{4k_F} &amp; \frac{1}{2k_FL} &amp; 0 &amp; -\frac{1}{4k_M}\\
\frac{1}{4k_F} &amp; 0 &amp; \frac{1}{2k_FL} &amp; \frac{1}{4k_M}\\
\frac{1}{4k_F} &amp; -\frac{1}{2k_FL} &amp; 0 &amp; -\frac{1}{4k_M}
\end{bmatrix}
\begin{bmatrix}
F \\ M_x \\ M_y \\ M_z
\end{bmatrix}\tag{4}
\]</div>
<p>其中 <span class="arithmatex">\(F\)</span> 是总升力，<span class="arithmatex">\(L\)</span> 是旋臂长度。</p>
<p>然后是两个动力学方程：</p>
<div class="arithmatex">\[m\ddot{\mathbf{r}} = -mg\mathbf{z}_{W} + u_1\mathbf{z}_B \tag{5}\]</div>
<div class="arithmatex">\[\begin{bmatrix}u_2\\u_3\\u_4\end{bmatrix} = \mathcal{I}\dot{\omega}_{\mathcal{BW}} + \omega_{\mathcal{BW}} \times \mathcal{I}\omega_{\mathcal{BW}} \tag{6}\]</div>
<p>这里的 <span class="arithmatex">\(\mathcal{I}\)</span> 代表四旋翼的惯性张量。</p>
<p>我们定义四旋翼的状态变量</p>
<div class="arithmatex">\[\mathbf{x} = \begin{bmatrix}x &amp; y &amp; z &amp; \phi &amp; \theta &amp; \psi &amp; \dot{x} &amp; \dot{y} &amp; \dot{z} &amp; p &amp; q &amp; r\end{bmatrix}^T\]</div>
<hr />
<h2 id="3">3 四旋翼模型的微分平坦性证明</h2>
<p>我们选取的输出量是</p>
<div class="arithmatex">\[\sigma = \begin{bmatrix}x\\ y\\ z\\ \psi\end{bmatrix} = \begin{bmatrix}\mathbf{r}\\ \psi\end{bmatrix}\]</div>
<p>已知量包括四旋翼质量 <span class="arithmatex">\(m\)</span>，惯性张量 <span class="arithmatex">\(\mathcal{I}\)</span>，重力加速度 <span class="arithmatex">\(g\)</span> .</p>
<p>我们需要说明，可以通过 <span class="arithmatex">\(\sigma\)</span> 及 <span class="arithmatex">\(\sigma\)</span> 的有限阶导数表示 <span class="arithmatex">\(\mathbf{u}\)</span> 和 <span class="arithmatex">\(\mathbf{x}\)</span> （共 16 个量）。</p>
<h3 id="31-6">3.1 位置和线速度（6 个量）</h3>
<p>我们选取的输出量及其一阶导数中直接包含了四旋翼的位置和线速度信息：</p>
<div class="arithmatex">\[\begin{bmatrix}x \\ y \\ z \\ \dot x \\ \dot y \\ \dot z\end{bmatrix} = \begin{bmatrix}\sigma_1 \\ \sigma_2 \\ \sigma_3 \\ \dot \sigma_1 \\ \dot \sigma_2 \\ \dot \sigma_3\end{bmatrix} \tag{Result 1}\]</div>
<hr />
<h3 id="32-4">3.2 推力与姿态（4 个量）</h3>
<p>四旋翼的姿态既可用欧拉角表示，也可用旋转矩阵表示，二者关系为</p>
<div class="arithmatex">\[\begin{aligned}
^WR_{B} &amp;= R_{Z,\psi}R_{X,\phi}R_{Y,\theta}\\
&amp;= \begin{bmatrix}c\psi &amp; -s\psi &amp; 0 \\ s\psi &amp; c\psi &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}
\begin{bmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; c\phi &amp; -s\phi \\ 0 &amp; s\phi &amp; c\phi \end{bmatrix}
\begin{bmatrix}c\theta &amp; 0 &amp; s\theta \\ 0 &amp; 1 &amp; 0 \\ -s\theta &amp; 0 &amp; c\theta \end{bmatrix}\\
&amp;= \begin{bmatrix}c\psi &amp; -s\psi c\phi &amp; s\psi s\phi\\
s\psi &amp; c\psi c\phi &amp; -c\psi s\phi\\
0 &amp; s\phi &amp; c\phi
\end{bmatrix}\begin{bmatrix}c\theta &amp; 0 &amp; s\theta \\ 0 &amp; 1 &amp; 0 \\ -s\theta &amp; 0 &amp; c\theta \end{bmatrix}\\
&amp;= \begin{bmatrix}c\psi c\theta-s\psi s\phi s\theta &amp; -s\psi c\phi &amp; c\psi s\theta +s\psi s\phi c\theta\\
s\psi c\theta + c\psi s\phi s\theta &amp; c\psi c\phi &amp; s\psi s\theta -c\psi s\phi c\theta\\
-c\phi s\theta &amp; s\phi &amp; c\phi c\theta
\end{bmatrix}
\end{aligned}\]</div>
<p>设 <span class="arithmatex">\(^WR_B = \begin{bmatrix}\mathbf{x}_B &amp; \mathbf{y}_B &amp; \mathbf{z}_B\end{bmatrix}\)</span>，要求 <span class="arithmatex">\(\psi, \phi, \theta\)</span>，就等同于求 <span class="arithmatex">\(\mathbf{x}_B, \mathbf{y}_B, \mathbf{z}_B\)</span> .</p>
<p>首先，根据 (5) 式，我们有</p>
<div class="arithmatex">\[\begin{aligned}
m\begin{bmatrix}\ddot{\sigma}_1\\ \ddot{\sigma}_2\\ \ddot{\sigma}_3\end{bmatrix} + mg\begin{bmatrix}0 \\ 0\\ 1\end{bmatrix} &amp;= u_1 \mathbf{z}_B\\
m\begin{bmatrix}\ddot{\sigma}_1\\ \ddot{\sigma}_2\\ \ddot{\sigma}_3 + g\end{bmatrix} &amp;= u_1\mathbf{z}_B
\end{aligned}\]</div>
<p>利用 <span class="arithmatex">\(\mathbf{z}_B\)</span> 的单位长度性质，可以推得</p>
<div class="arithmatex">\[\mathbf{z}_B = \frac{\mathbf{t}}{\left \| \mathbf{t} \right\|},\mathbf{t} = \begin{bmatrix}\ddot{\sigma}_1&amp; \ddot{\sigma}_2 &amp; \ddot{\sigma}_3+g\end{bmatrix}^T \tag{Result 2}\]</div>
<p>以及</p>
<div class="arithmatex">\[u_1 = m \left\| \mathbf{t} \right\| \tag{Result 3}\]</div>
<p>因为我们采用 Z-X-Y 欧拉角，所以 <span class="arithmatex">\(\mathbf{x}_B\)</span> 是 <span class="arithmatex">\(\mathbf{x}_C\)</span> 绕 <span class="arithmatex">\(\mathbf{y}_B\)</span> 旋转 <span class="arithmatex">\(\phi\)</span> 得到的。换言之，<span class="arithmatex">\(\mathbf{x}_B\)</span> 和 <span class="arithmatex">\(\mathbf{x}_C\)</span> 共面且垂直 <span class="arithmatex">\(\mathbf{y}_B\)</span> . 因为 <span class="arithmatex">\(\mathbf{z}_B\)</span> 也与 <span class="arithmatex">\(\mathbf{x}_B\)</span> 共面且垂直 <span class="arithmatex">\(\mathbf{y}_B\)</span>，所以 <span class="arithmatex">\(\mathbf{z}_B\)</span> ，<span class="arithmatex">\(\mathbf{x}_B\)</span> 和 <span class="arithmatex">\(\mathbf{x}_C\)</span> 共面。因此，有</p>
<div class="arithmatex">\[\mathbf{y}_B = \frac{\mathbf{z}_B \times \mathbf{x}_B}{\left\| \mathbf{z}_B \times \mathbf{x}_B \right\|} = \frac{\mathbf{z}_B \times \mathbf{x}_C}{\left\| \mathbf{z}_B \times \mathbf{x}_C \right\|}\]</div>
<blockquote>
<p>【注意（欧拉角的奇异性）】：当 <span class="arithmatex">\(\phi = \pm \pi / 2\)</span> 的时候，<span class="arithmatex">\(\mathbf{z}_B\)</span> 和 <span class="arithmatex">\(\mathbf{x}_C\)</span> 会共线，此时无法使用上式求解。</p>
</blockquote>
<p>上一步已求得 <span class="arithmatex">\(\mathbf{z}_B\)</span>，而 <span class="arithmatex">\(\mathbf{x}_C\)</span> 是世界坐标系绕 z 轴旋转 <span class="arithmatex">\(\psi\)</span> 角，因此显然等于 <span class="arithmatex">\(\begin{bmatrix}\cos\sigma_4, \sin\sigma_4, 0\end{bmatrix}^T\)</span> 。</p>
<div class="arithmatex">\[\mathbf{y}_B = \frac{\mathbf{z}_B \times \begin{bmatrix}\cos\sigma_4, \sin\sigma_4, 0\end{bmatrix}^T}{\left\| \mathbf{z}_B \times \begin{bmatrix}\cos\sigma_4, \sin\sigma_4, 0\end{bmatrix}^T\right\|} \tag{Result 4}\]</div>
<p>求得 <span class="arithmatex">\(\mathbf{z}_B\)</span> 和 <span class="arithmatex">\(\mathbf{y}_B\)</span> 后，我们可以轻松得到</p>
<div class="arithmatex">\[\mathbf{x}_B = \mathbf{y}_B \times \mathbf{z}_B \tag{Result 5}\]</div>
<hr />
<h3 id="33-3">3.3 角速度（3 个量）</h3>
<p>设</p>
<div class="arithmatex">\[\mathbf{a} = \ddot{\mathbf{r}} = \begin{bmatrix}\ddot{\sigma}_1 &amp; \ddot{\sigma}_2 &amp; \ddot{\sigma}_3\end{bmatrix}^T\tag{Result 6}\]</div>
<p>对 (5) 式等号两边求一阶导可以得到</p>
<div class="arithmatex">\[\begin{aligned}m\dot{\mathbf{a}} &amp;= 0 + \dot{u}_1 \mathbf{z}_B + u_1\dot{\mathbf{z}}_B\\
&amp;= \dot{u}_1\mathbf{z}_B + u_1\dot{\left(^WR_B\right)}\left(^B\mathbf{z}_B\right)\\
&amp;= \dot{u}_1\mathbf{z}_B + u_1 \omega_{\mathcal{BW}} \times\left(^WR_B\right)\left(^B\mathbf{z}_B\right)\\
&amp;= \dot{u}_1\mathbf{z}_B + u_1\omega_{\mathcal{BW}} \times \mathbf{z}_B\\
\end{aligned} \tag{7}\]</div>
<p>在 (7) 式左右两边同时点乘 <span class="arithmatex">\(\mathbf{z}_{B}\)</span>，则有</p>
<div class="arithmatex">\[\begin{aligned}
\mathbf{z}_B\cdot m\dot{\mathbf{a}} &amp;= \dot{u}_1\mathbf{z}_B\cdot\mathbf{z}_B + u_1\mathbf{z}_B\cdot(\omega_{\mathcal{BW}}\times\mathbf{z}_B)\\
&amp;= \dot{u}_1
\end{aligned}\tag{8}\]</div>
<p>把 (8) 式代入到 (7) 式，得到</p>
<div class="arithmatex">\[\begin{aligned}
 \omega_{\mathcal{BW}}  \times \mathbf{z}_B &amp;= \frac{1}{u_1}\left(m\dot{\mathbf{a}}-\dot{u}_1\mathbf{z}_B\right)\\
&amp;= \frac{m}{u_1}\left(\dot{\mathbf{a}}-\left(\mathbf{z}_B\cdot\dot{\mathbf{a}}\right)\mathbf{z}_B\right)\\
&amp; \overset{\Delta}= \mathbf{h}_{\omega}
\end{aligned} \tag{Result 7}\]</div>
<p>这里的 <span class="arithmatex">\(\mathbf{h}_{\omega}\)</span> 是 <span class="arithmatex">\(\frac{m}{u_1}\dot{\mathbf{a}}\)</span> 到一个垂直于 <span class="arithmatex">\(\mathbf{z}_B\)</span> 的平面的投影。</p>
<p>从另一个角度计算 <span class="arithmatex">\(\mathbf{h}_{\omega}\)</span> ：</p>
<p>以 <span class="arithmatex">\(\mathbf{x}_B, \mathbf{y}_B, \mathbf{z}_B\)</span> 作为一组基，则 <span class="arithmatex">\(\omega_{\mathcal{BW}}\)</span> 可以表示为 <span class="arithmatex">\(\begin{bmatrix}\mathbf{x}_{B}&amp; \mathbf{y}_B&amp; \mathbf{z}_B\end{bmatrix}\begin{bmatrix}p&amp; q&amp; r\end{bmatrix}^T\)</span>，<span class="arithmatex">\(\mathbf{z}_{B}\)</span> 可以表示为 <span class="arithmatex">\(\begin{bmatrix}\mathbf{x}_{B}&amp; \mathbf{y}_B&amp; \mathbf{z}_B\end{bmatrix}\begin{bmatrix}0 &amp; 0 &amp; 1\end{bmatrix}^T\)</span>，因此有</p>
<div class="arithmatex">\[\begin{aligned}
\mathbf{h}_{\omega} &amp;= \begin{bmatrix}\mathbf{x}_{B}&amp; \mathbf{y}_B&amp; \mathbf{z}_B\end{bmatrix}\left(\begin{bmatrix}p\\ q\\ r\end{bmatrix} \times \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}\right)\\
&amp;= \begin{bmatrix}\mathbf{x}_{B}&amp; \mathbf{y}_B&amp; \mathbf{z}_B\end{bmatrix}\begin{bmatrix}0 &amp; -r &amp; q\\ r &amp; 0 &amp; -p\\ -q &amp; p &amp; 0\end{bmatrix}\begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}\\
&amp;= \begin{bmatrix}\mathbf{x}_{B}&amp; \mathbf{y}_B&amp; \mathbf{z}_B\end{bmatrix}\begin{bmatrix}q \\ -p \\ 0\end{bmatrix}\\
&amp;= q\mathbf{x}_B -p\mathbf{y}_B
\end{aligned}\]</div>
<p>所以</p>
<div class="arithmatex">\[p = -\mathbf{h}_{\omega}\cdot \mathbf{y}_B,q = \mathbf{h}_{\omega}\cdot\mathbf{x}_B \tag{Result 8}\]</div>
<hr />
<p>接下来，利用 (1) 式和 (2) 式计算 <span class="arithmatex">\(r\)</span> ：</p>
<div class="arithmatex">\[\begin{aligned}
r &amp;= \left(p\mathbf{x}_B + q\mathbf{y}_B + r\mathbf{z}_{B}\right) \cdot \mathbf{z}_B\\
&amp;= \omega_{\mathcal{BW}} \cdot \mathbf{z}_{B}\\
&amp;= \left(\omega_{\mathcal{BD}} + \omega_{\mathcal{DC}_2} + \omega_{\mathcal{C}\mathcal{W}}\right)\cdot \mathbf{z}_B\\
&amp;= \left(\dot{\theta}\mathbf{y}_{D} + \dot\phi\mathbf{x}_{C_2} + \dot{\psi}\mathbf{z}_{W'}\right)\cdot\mathbf{z}_B\\
&amp;= \dot\phi\mathbf{x}_{C_2}\cdot\mathbf{z}_B + \dot{\psi}\mathbf{z}_{W'}\cdot\mathbf{z}_B \\
\end{aligned}\]</div>
<blockquote>
<p>【注意】论文此处推导出 <span class="arithmatex">\(r = \dot{\psi}\mathbf{z}_{W'}\cdot \mathbf{z}_B\)</span>，这是错误的。
Faessler M , Franchi A , Scaramuzza D .Differential Flatness of Quadrotor Dynamics Subject to Rotor Drag for Accurate Tracking of High-Speed Trajectories[J].IEEE Robotics &amp; Automation Letters, 2017, 3(2):620-626.DOI:10.1109/LRA.2017.2776353.
这篇文章在附录里也指出了这个错误，不过他们也没有完全理解原文作者的建系思路，给出的解释并不令人信服。</p>
</blockquote>
<p>其中，只有 <span class="arithmatex">\(\dot\phi\mathbf{x}_{C_2}\cdot\mathbf{z}_B = \dot\phi \cos(\frac{\pi}{2} - \theta) = \dot\phi \sin\theta\)</span> 是一个未知项。</p>
<p>我们利用刚刚求出的 <span class="arithmatex">\(p\)</span> ，同样结合 (1) 式和 (2) 式求解该项：</p>
<div class="arithmatex">\[\begin{aligned}
p &amp;= \left(p\mathbf{x}_B + q\mathbf{y}_B + r\mathbf{z}_{B}\right)\cdot \mathbf{x}_B\\
&amp;=\omega_{\mathcal{BW}}\cdot \mathbf{x}_B\\
&amp;= (\dot{\theta}\mathbf{y}_{D} + \dot\phi\mathbf{x}_{C_2} + \dot{\psi}\mathbf{z}_{W'})\cdot\mathbf{x}_B\\
&amp;= \dot\phi \mathbf{x}_{C_2}\cdot\mathbf{x}_B + \dot\psi\mathbf{z}_{W'}\cdot \mathbf{x}_B\\
\Rightarrow \dot\phi\mathbf{x}_{C_2}\cdot\mathbf{x}_B &amp;= p - \dot\psi \mathbf{z}_{W'}\cdot \mathbf{x}_B\\
\Rightarrow \dot\phi \cos\theta &amp;= p - \dot\psi \mathbf{z}_{W'}\cdot \mathbf{x}_B
\end{aligned}\]</div>
<p>从而有</p>
<div class="arithmatex">\[\begin{aligned}
r &amp;= (p - \dot\psi \mathbf{z}_{W'}\cdot \mathbf{x}_B) \tan\theta + \dot{\psi}\mathbf{z}_{W'}\cdot\mathbf{z}_B \\
\end{aligned}\]</div>
<blockquote>
<p>【注意：（欧拉角的奇异性）】 <span class="arithmatex">\(\tan\theta\)</span> 可能会发散。</p>
</blockquote>
<p>这里的 <span class="arithmatex">\(\mathbf{z}_{W'} = \mathbf{z}_{W} = \begin{bmatrix}0 &amp; 0 &amp; 1\end{bmatrix}^T\)</span> .</p>
<hr />
<p>还有一种做法：</p>
<div class="arithmatex">\[\begin{aligned}
r &amp;= -\mathbf{x}_B \cdot \dot{(\mathbf{y}_B)}\\
&amp;= -\mathbf{x}_B \cdot(\omega_{BW} \times \mathbf{y}_B)\\
&amp;= -\mathbf{x}_B \cdot \left(\begin{bmatrix}\mathbf{x}_B &amp; \mathbf{y}_B &amp; \mathbf{z}_B\end{bmatrix}\left(\begin{bmatrix}p\\q\\r\end{bmatrix}\times \begin{bmatrix}0\\1\\0\end{bmatrix}\right)\right)\\
&amp;= -\mathbf{x}_B \cdot \left(-r\mathbf{x}_B + p\mathbf{z}_B \right)
\end{aligned}\]</div>
<p>因为 <span class="arithmatex">\(\mathbf{y}_B\)</span> 同时垂直于 <span class="arithmatex">\(\mathbf{z}_B\)</span>  ，<span class="arithmatex">\(\mathbf{x}_C\)</span> ，所以 <span class="arithmatex">\(\mathbf{y}_B = \frac{\mathbf{z}_B \times \mathbf{x}_C}{\left\| \mathbf{z}_B \times \mathbf{x}_C \right\|}\)</span> ，所以有：</p>
<div class="arithmatex">\[\begin{aligned}
\dot{\mathbf{y}_B} &amp;= \frac{\dot{(\mathbf{z}_B \times \mathbf{x}_C)}}{\left\| \mathbf{z}_B \times \mathbf{x}_C \right\|} - (\mathbf{z}_B \times \mathbf{x}_C) \frac{(\mathbf{z}_B \times \mathbf{x}_C)\cdot \dot{(\mathbf{z}_B \times \mathbf{x}_C)}}{\left\| \mathbf{z}_B \times \mathbf{x}_C\right\|^3}\\
\end{aligned}\]</div>
<p>因为 <span class="arithmatex">\(\mathbf{y}_B\)</span> 垂直 <span class="arithmatex">\(\mathbf{x}_B\)</span> ，所以</p>
<div class="arithmatex">\[r = -\mathbf{x}_B\cdot \dot{\mathbf{y}_B} = -\mathbf{x}_B\frac{\dot{(\mathbf{z}_B \times \mathbf{x}_C)}}{\left\| \mathbf{z}_B \times \mathbf{x}_C \right\|}\]</div>
<p>其中，<span class="arithmatex">\(\dot{(\mathbf{z}_B \times \mathbf{x}_C)}\)</span> 可以如下计算：</p>
<div class="arithmatex">\[\begin{aligned}
\dot{(\mathbf{z}_B \times \mathbf{x}_C)} &amp;= \dot{\mathbf{z}_B}\times\mathbf{x}_C + \mathbf{z}_B \times \dot{\mathbf{x}_C}\\
&amp;= \omega_{BW}\times\mathbf{z}_B \times \mathbf{x}_C + \mathbf{z}_B \times \left(\omega_{CW}\times\mathbf{x}_C \right)\\
&amp;= \begin{bmatrix}\mathbf{x}_B &amp; \mathbf{y}_B &amp; \mathbf{z}_B\end{bmatrix} \cdot \left(\begin{bmatrix}p \\q\\r\end{bmatrix}\times\begin{bmatrix}0 \\0 \\1\end{bmatrix}\right) \times \mathbf{x}_C\\
&amp; \ \ \ \ \ \ + \mathbf{z}_B \times \left(\begin{bmatrix}\mathbf{x}_C &amp; \mathbf{y}_C &amp; \mathbf{z}_C\end{bmatrix} \cdot \left(\begin{bmatrix}0 \\0\\ \dot{\psi}\end{bmatrix}\times\begin{bmatrix}1 \\0 \\0\end{bmatrix}\right) \right)\\
&amp;= (q\mathbf{x}_B-p\mathbf{y}_B)\times\mathbf{x}_C + \mathbf{z}_B \times \left(\dot\psi \mathbf{y}_C \right)
\end{aligned}\]</div>
<p>所以</p>
<div class="arithmatex">\[r = \frac{\mathbf{x}_B \left( p\left(\mathbf{y}_B\times\mathbf{x}_C\right) - \dot\psi \left(\mathbf{z_B}\times\mathbf{y_C}\right)\right) }{\left\| \mathbf{z}_B \times \mathbf{x}_C \right\|} \tag{result 9}\]</div>
<blockquote>
<p>【注意（欧拉角的奇异性）：】 <span class="arithmatex">\(\left\|\mathbf{z}_B \times \mathbf{x}_C\right\|\)</span> 可能为 0 .</p>
</blockquote>
<hr />
<h3 id="34-3">3.4 三轴力矩（3 个量）</h3>
<p>考虑 (6) 式，<span class="arithmatex">\(\mathcal{I}\)</span> 和 <span class="arithmatex">\(\omega_{\mathcal{WB}}\)</span> 已知，要求出 <span class="arithmatex">\(u_2, u_3, u_4\)</span>，只需要求出 <span class="arithmatex">\(\dot{\omega}_{\mathcal{WB}}\)</span> . 接下来，使用 3.3 节中的方法求出  <span class="arithmatex">\(\dot{\omega}_{\mathcal{WB}}\)</span> 在 <span class="arithmatex">\(\mathbf{x}_B\)</span> 和 <span class="arithmatex">\(\mathbf{y}_B\)</span> 方向上的分量：</p>
<p>对 (5) 式求两阶导，得到</p>
<div class="arithmatex">\[\begin{aligned}
m\ddot{\mathbf{a}} &amp;= \ddot{u}_1\mathbf{z}_B + \dot{u}_1\omega_{\mathcal{BW}}\times \mathbf{z}_B + \dot{u}_1\omega_{\mathcal{BW}}\times \mathbf{z}_B + u_1 \frac{\mathrm{d}(\omega_{\mathcal{BW}}\times \mathbf{z}_B)}{\mathrm{d}t}\\
&amp;= \ddot{u}_1\mathbf{z}_B + 2\dot{u}_1\omega_{\mathcal{BW}}\times \mathbf{z}_B + u_1 \dot{\omega_{\mathcal{BW}}} \times\mathbf{z}_B + u_1 \omega_{\mathcal{BW}} \times (\omega_{\mathcal{BW}}\times \mathbf{z}_B)\\
\end{aligned} \tag{9}\]</div>
<p>对 (9) 式左右两边同时点乘 <span class="arithmatex">\(\mathbf{z}_B\)</span>，得到</p>
<div class="arithmatex">\[\begin{aligned}
m\ddot{\mathbf{a}} \cdot \mathbf{z}_B &amp;= \ddot{u}_1 + u_1\omega_{\mathcal{BW}}\times(\omega_{\mathcal{BW}}\times\mathbf{z}_B)\cdot \mathbf{z}_B\\
\Rightarrow \ddot{u}_1 &amp;= u_1\omega_{\mathcal{BW}}\times(\omega_{\mathcal{BW}}\times\mathbf{z}_B)\cdot \mathbf{z}_B - m\ddot{\mathbf{a}} \cdot \mathbf{z}_B
\end{aligned} \tag{10}\]</div>
<p>把 (10) 式代入 (9) 式，得到</p>
<div class="arithmatex">\[\begin{aligned}
u_1 \dot{\omega_{\mathcal{BW}}} \times\mathbf{z}_B &amp;= m\ddot{\mathbf{a}} - \left( u_1\omega_{\mathcal{BW}}\times(\omega_{\mathcal{BW}}\times\mathbf{z}_B)\cdot \mathbf{z}_B - m\ddot{\mathbf{a}} \cdot \mathbf{z}_B \right) \mathbf{z}_B\\
&amp; \ \ \ \ \ \  - 2(\mathbf{z}_B\cdot m\mathbf{a})\omega_{\mathcal{BW}}\times \mathbf{z}_B - u_1 \omega_{\mathcal{BW}} \times (\omega_{\mathcal{BW}}\times \mathbf{z}_B)
\end{aligned}\]</div>
<p>设</p>
<div class="arithmatex">\[\dot{\omega_{\mathcal{BW}}} = \begin{bmatrix}\mathbf{x}_B &amp; \mathbf{y}_B &amp; \mathbf{z}_B\end{bmatrix}\begin{bmatrix}\omega_{a1} \\ \omega_{a2} \\ \omega_{a3}\end{bmatrix} \tag{result 10}\]</div>
<p>则</p>
<div class="arithmatex">\[\dot{\omega_{\mathcal{BW}}} \times \mathbf{z}_B = \omega_{a2}\mathbf{y}_B - \omega_{a1}\mathbf{x}_B\]</div>
<p>则有</p>
<div class="arithmatex">\[\begin{aligned}
\omega_{a2} &amp;= (\dot{\omega_{\mathcal{BW}}}\times \mathbf{z}_B)\cdot \mathbf{x}_B\\
&amp;= \frac{m}{u_1} \left( \ddot{\mathbf{a}} - 2(\mathbf{z}_B\cdot \mathbf{a})\omega_{\mathcal{BW}}\times \mathbf{z}_B \right)\cdot \mathbf{x}_B\\
&amp;\ \ \ \ - \omega_{\mathcal{BW}} \times (\omega_{\mathcal{BW}}\times \mathbf{z}_B)\cdot \mathbf{x}_B
\end{aligned} \tag{result 11}\]</div>
<div class="arithmatex">\[\begin{aligned}
\omega_{a1} &amp;= -\frac{m}{u_1} \left( \ddot{\mathbf{a}} - 2(\mathbf{z}_B\cdot \mathbf{a})\omega_{\mathcal{BW}}\times \mathbf{z}_B \right)\cdot \mathbf{y}_B\\
&amp;\ \ \ \ + \omega_{\mathcal{BW}} \times (\omega_{\mathcal{BW}}\times \mathbf{z}_B)\cdot \mathbf{y}_B
\end{aligned} \tag{result 12}\]</div>
<hr />
<p>从另一个视角理解一下 <span class="arithmatex">\(\dot{\omega_{BW}}\)</span>：</p>
<div class="arithmatex">\[\begin{aligned}
\dot{\omega_{BW}} &amp;= \dot{(^WR_B)}\begin{bmatrix}p\\ q\\ r\end{bmatrix} + \begin{bmatrix}\mathbf{x}_B &amp;  \mathbf{y}_B &amp; \mathbf{z}_B\end{bmatrix}\begin{bmatrix}\dot p\\ \dot q\\ \dot r\end{bmatrix}\\
&amp;= \omega_{BW} \times \omega_{BW} + \left(^WR_B\right)\dot{\left(^B\omega_B\right)}\\
&amp;= \left(^WR_B\right)\dot{\left(^B\omega_B\right)}
\end{aligned}\]</div>
<p>所以，<span class="arithmatex">\(\begin{bmatrix}\omega_{a1} &amp; \omega_{a2} &amp; \omega_{a3}\end{bmatrix}^T = \begin{bmatrix}\dot p &amp; \dot q&amp; \dot r\end{bmatrix}^T\)</span> .</p>
<p>要对 <span class="arithmatex">\(r\)</span> （参见result 9 式）求导是一个有点复杂的事情，我们一点点来。</p>
<div class="arithmatex">\[\begin{aligned}
\frac{\mathrm{d}\left( p\left(\mathbf{y}_B\times\mathbf{x}_C\right)\right) }{\mathrm{d}t} &amp;= \dot{p}(\mathbf{y}_B\times\mathbf{x}_C) + p(\omega_{BW}\times\mathbf{y}_B\times\mathbf{x}_C + \mathbf{y}_B\times(\omega_{CW}\times\mathbf{x}_C))\\
&amp;= \dot{p}(\mathbf{y}_B\times\mathbf{x}_C) + p((p\mathbf{z}_B-r\mathbf{x}_B)\times \mathbf{x}_C + \dot\psi\mathbf{y}_B\times \mathbf{y}_C)\\
\frac{\mathrm{d}\left( \dot\psi\left(\mathbf{z}_B\times\mathbf{y}_C\right)\right) }{\mathrm{d}t} &amp;= \ddot\psi(\mathbf{z}_B\times\mathbf{y}_C) + \dot\psi(\omega_{BW}\times\mathbf{z}_B\times\mathbf{y}_C + \mathbf{z}_B \times(\omega_{CW}\times \mathbf{y}_C))\\
&amp;= \ddot\psi(\mathbf{z}_B\times\mathbf{y}_C) + \dot\psi((q\mathbf{x}_B-p\mathbf{y}_B)\times\mathbf{y}_C -\dot\psi\mathbf{z}_B\times\mathbf{x}_C )\\
\dot{\mathbf{x}_B}(p\left(\mathbf{y}_B\times\mathbf{x}_C\right) -&amp; \dot\psi \left(\mathbf{z_B}\times\mathbf{y_C}\right))\\
&amp;= (r\mathbf{y}_B-q\mathbf{z}_B)(p\left(\mathbf{y}_B\times\mathbf{x}_C\right) - \dot\psi \left(\mathbf{z_B}\times\mathbf{y_C}\right))\\
&amp;= -r\dot{\psi}\mathbf{y}_B\cdot (\mathbf{z}_B\times\mathbf{y}_C)-pq\mathbf{z}_B\cdot(\mathbf{y}_B\times\mathbf{x_C})
\end{aligned}\]</div>
<div class="arithmatex">\[\begin{aligned}
\dot r &amp;= \frac{\mathbf{x}_B\left(\frac{\mathrm{d}\left( p\left(\mathbf{y}_B\times\mathbf{x}_C\right)\right) }{\mathrm{d}t} - \frac{\mathrm{d}\left( \dot\psi\left(\mathbf{z}_B\times\mathbf{y}_C\right)\right) }{\mathrm{d}t}\right)-r\dot{\psi}\mathbf{y}_B\cdot (\mathbf{z}_B\times\mathbf{y}_C)-pq\mathbf{z}_B\cdot(\mathbf{y}_B\times\mathbf{x_C})}{\left\|\mathbf{z}_B\times\mathbf{x}_C\right\|}\\
&amp;\ \ \ \ \ \ - \left(\mathbf{x}_B \left( p\left(\mathbf{y}_B\times\mathbf{x}_C\right) - \dot\psi \left(\mathbf{z_B}\times\mathbf{y_C}\right)\right)\right)\\
&amp;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \cdot\frac{(\mathbf{z}_B\times\mathbf{x}_C) \cdot \left((q\mathbf{x}_B-p\mathbf{y}_B)\times\mathbf{x}_C + \mathbf{z}_B \times \left(\dot\psi \mathbf{y}_C \right)\right)}{\left\| \mathbf{z}_B \times \mathbf{x}_C \right\|^3}
\end{aligned}\tag{result 13}\]</div>
<blockquote>
<p>【注意（欧拉角的奇异性）：】 <span class="arithmatex">\(\left\|\mathbf{z}_B \times \mathbf{x}_C\right\|\)</span> 可能为 0 .</p>
</blockquote>
<hr />
<h3 id="35">3.5 小结</h3>
<p>综合上述 (result 1-13) 式 以及 (6) 式，即可用 <span class="arithmatex">\(\sigma\)</span> 以及 <span class="arithmatex">\(\sigma\)</span> 的有限阶导数，表示系统的所有状态变量以及输入变量，即证明了四旋翼系统具有微分平坦的性质。</p>
<p>需要注意的是，上文讨论忽略了 <span class="arithmatex">\(\mathbf{z}_B\)</span> 与 <span class="arithmatex">\(\mathbf{x}_C\)</span> 重合（欧拉角奇异性）的位置。</p>
<hr />
<h2 id="4">4 控制器设计</h2>
<p>首先，定义我们的期望值 <span class="arithmatex">\(\sigma_T(t) = \begin{bmatrix}\mathbf{r}_T(t)^T &amp; \psi_T(t)\end{bmatrix}^T\)</span> ，从而定义位置和速度上的两个误差，分别为 <span class="arithmatex">\(\mathbf{e}_p = \mathbf{r} - \mathbf{r}_T\)</span> 和 <span class="arithmatex">\(\mathbf{e}_v = \dot{\mathbf{r}} - \dot{\mathbf{r}}_T\)</span> .</p>
<blockquote>
<p>论文原文计算误差就是用反馈值减去期望值，这与常规的 err = ref - fdb 不太一致。正因此，下文的控制器设计时，需要在 err 一项的系数前加负号。</p>
</blockquote>
<h3 id="41">4.1 推力</h3>
<p>设计控制器，如下计算四旋翼的期望推力</p>
<div class="arithmatex">\[\mathbf{F}_{des} = -K_p\mathbf{e}_p - K_v\mathbf{e}_v + mg\mathbf{z}_{W} + m\ddot{\mathbf{r}}_T\]</div>
<p>并且我们将其与当前机体坐标系的 Z 轴做点乘，以获得 <span class="arithmatex">\(u_1\)</span> ，即</p>
<div class="arithmatex">\[u_1 = \mathbf{F}_{des}\cdot \mathbf{z}_B\]</div>
<blockquote>
<p>四旋翼是一个欠驱动系统，只能产生 <span class="arithmatex">\(\mathbf{z}_B\)</span> 轴方向上的推力。</p>
</blockquote>
<hr />
<h3 id="42">4.2 力矩</h3>
<p>4.1 节中我们计算的四旋翼期望推力是三轴的，但是由于四旋翼构型限制，我们被迫放弃了其中的 <span class="arithmatex">\(\mathbf{x}_B\)</span> 和 <span class="arithmatex">\(\mathbf{y}_B\)</span> 轴的分量。为了不丢失这部分分量，我们需要使 <span class="arithmatex">\(\mathbf{z}_B\)</span> 轴与 <span class="arithmatex">\(\mathbf{F}_{des}\)</span> 的方向保持一致，即</p>
<div class="arithmatex">\[\mathbf{z}_{B,des} = \frac{\mathbf{F}_{des}}{\left\| \mathbf{F}_{des} \right\|}\]</div>
<p>根据 <span class="arithmatex">\(\psi_{des}\)</span>，我们可以求出 <span class="arithmatex">\(\mathbf{x}_{C,des} = \begin{bmatrix}c\psi &amp; s\psi &amp; 0\end{bmatrix}^T\)</span> . 因为 <span class="arithmatex">\(\mathbf{x}_{C_2}\)</span> 和 <span class="arithmatex">\(\mathbf{x}_{D}\)</span> 重合，又因为 <span class="arithmatex">\(\mathbf{z}_D\)</span> 和 <span class="arithmatex">\(\mathbf{x}_D\)</span> 绕着 <span class="arithmatex">\(\mathbf{y}_D(\mathbf{y}_B)\)</span> 旋转分别生成 <span class="arithmatex">\(\mathbf{z}_B\)</span> 和 <span class="arithmatex">\(\mathbf{x}_B\)</span>，所以 <span class="arithmatex">\(\mathbf{z}_B\)</span> 和 <span class="arithmatex">\(\mathbf{x}_D\)</span>，<span class="arithmatex">\(\mathbf{x}_B\)</span> 共面，且都垂直于 <span class="arithmatex">\(\mathbf{y}_B\)</span> . 所以有</p>
<div class="arithmatex">\[\mathbf{y}_{B,des} = \frac{\mathbf{z}_{B,des}\times\mathbf{x}_{C,des}}{\left\| \mathbf{z}_{B,des}\times\mathbf{x}_{C,des} \right\|}\]</div>
<p>以及</p>
<div class="arithmatex">\[\mathbf{x}_{B,des} = \mathbf{y}_{B,des}\times \mathbf{z}_{B,des}\]</div>
<blockquote>
<p>【注意（过零问题）】工程实践上，当 <span class="arithmatex">\(\mathbf{z}_{B,des}\)</span> 与 <span class="arithmatex">\(\mathbf{x}_{C,des}\)</span> 的顺逆时针关系一旦发生改变，<span class="arithmatex">\(\mathbf{y}_B, \mathbf{x}_B\)</span> 的方向会立刻发生 180° 的偏转。倘若 <span class="arithmatex">\(\mathbf{z}_{B,des}\)</span> 和 <span class="arithmatex">\(\mathbf{x}_{C,des}\)</span> 的夹角频繁在 0 附近变化，<span class="arithmatex">\(\mathbf{y}_B, \mathbf{x}_B\)</span> 的方向会频繁发生 180° 的大偏转，导致四旋翼失稳。论文特意强调了这一点，并给出解决方案：在没有额外约束的情况下，<span class="arithmatex">\(\mathbf{x}_{B,des},\mathbf{y}_{B,des}\)</span> 和 <span class="arithmatex">\(-\mathbf{x}_{B,des},-\mathbf{y}_{B,des}\)</span> 都能满足 <span class="arithmatex">\(\psi_{des}\)</span> 和 <span class="arithmatex">\(\mathbf{z}_{B,des}\)</span>，因此工程实践中，哪对结果与当前姿态更接近，就应该选择那对结果，以保证控制的稳定性。</p>
</blockquote>
<p>从而有</p>
<div class="arithmatex">\[\left(^WR_B\right)_{des} = \begin{bmatrix}\mathbf{x}_{B,des} &amp; \mathbf{y}_{B,des} &amp; \mathbf{z}_{B,des}\end{bmatrix}\]</div>
<p>要使四旋翼机体姿态发生如上旋转，只能依赖于改变其三轴力矩。同样地，利用反馈式控制的思路，我们先定义姿态误差：</p>
<div class="arithmatex">\[\mathbf{e}_{R} = \frac{1}{2}\left(R_{des}^T \left(^WR_B\right) - (^WR_B)^TR_{des} \right)^{\vee}\]</div>
<p>以及角速度误差：</p>
<div class="arithmatex">\[\mathbf{e}_{\omega} = \left(^B\omega_B - (^B\omega_{B,des})\right)\]</div>
<p>这里的角速度由 3.3 节所求的 p, q, r 组成，即</p>
<div class="arithmatex">\[(^B\omega_{B,des}) = \begin{bmatrix}p &amp; q &amp; r\end{bmatrix}^T\]</div>
<p>在已经求出期望姿态的情况下，我们可以按照 3.3 节的方式求出角速度期望值。</p>
<p>设计控制器，如下计算四旋翼的期望推力</p>
<div class="arithmatex">\[\begin{bmatrix}u_2 &amp; u_3 &amp; u_4\end{bmatrix}^T = -K_R\mathbf{e}_{R} - K_\omega\mathbf{e}_{\omega}\]</div>
<hr />
<h3 id="43">4.3 螺旋桨转速</h3>
<p>利用 4.1 节和 4.2 节分别求出的期望推力和期望力矩，结合 (6) 式，即可求得螺旋桨期望转速的平方，开个根号即得四个螺旋桨的期望转速。</p>
<h3 id="44">4.4 控制器稳定性、收敛性分析</h3>
<p>论文并未详细分析所给出的控制器的稳定性和收敛性，但是指出有一篇类似的文章做了这些工作：T. Lee, M. Leok, and N. McClamroch, "Geometric tracking control of a quadrotor uav on SE(3)," in <em>Proc. of the IEEE Conf. on Decision and Control</em>, 2010.</p>
<hr />
<h2 id="5">5 轨迹生成</h2>
<h3 id="51">5.1 限制条件</h3>
<p>人为给出一系列关键帧，每个关键帧包括一个位置坐标，一个 yaw 轴角度 <span class="arithmatex">\(\psi\)</span> 以及一个时间。在每个关键帧之间有一个安全通道，在两个关键帧时刻之间，四旋翼必须处在这个安全通道之中。</p>
<p>一种简单的做法是在四维空间中直接用直线把两个关键帧连起来。但是这样效率很低，因为每个关键帧处，轨迹的曲率无穷大；所以四旋翼必须在每个关键帧处都停一下，转一下，再继续飞。</p>
<h3 id="52">5.2 基于微分平坦定义轨迹优化问题</h3>
<p>论文提出了一种基于微分平坦的最小 snap 轨迹生成算法。</p>
<p>首先，根据微分平坦的知识，我们知道，可以用 <span class="arithmatex">\(\sigma\)</span> 定义四旋翼的一条光滑轨迹 <span class="arithmatex">\(\sigma(t)\)</span></p>
<div class="arithmatex">\[ \sigma(t) : [t_0, t_m] \rightarrow \mathbb{R}^3 \times SO(2) \]</div>
<p>这里，<span class="arithmatex">\(\sigma_4 = \psi\)</span> 这一 yaw 轴角度即可完整定义一个二维旋转矩阵，即 SO(2) 中的对象。</p>
<p>我们用分段多项式描述这条光滑轨迹</p>
<div class="arithmatex">\[\sigma_T(t) = \begin{cases}
\sum_{i=0}^n\sigma_{T_i1}t^{i} &amp; t_0\le t &lt; t_1\\
\sum_{i=0}^n\sigma_{T_i2}t^{i} &amp; t_1\le t &lt; t_2\\
\sum_{i=0}^n\sigma_{T_i3}t^{i} &amp; t_2\le t &lt; t_3\\
&amp;\vdots\\
\sum_{i=0}^n\sigma_{T_im}t^{i} &amp; t_{m-1}\le t &lt; t_m\\
\end{cases}\]</div>
<p>接下来，我们把轨迹生成定义为一个优化问题</p>
<div class="arithmatex">\[\begin{aligned}
\min&amp; \int_{t_0}^{t_m} \mu_r \left\| \frac{\mathrm{d}^{k_r}\mathbf{r}_T}{\mathrm{d}t^{k_r}} \right\|^2 + \mu_{\psi}\frac{\mathrm{d}^{k_{\psi}}\psi_{T}}{\mathrm{d}t^{k_\psi}}^2 \mathrm{d} t\\
\text{s.t.}&amp; \ \ \ \ \  \sigma_{T}(t_i) = \sigma_i, \ \ \ \ i = 0, ..., m
\end{aligned} \tag{11}\]</div>
<p>同时要求 <span class="arithmatex">\(\mathbf{r}_T\)</span> 的前 <span class="arithmatex">\(k_r\)</span> 阶导数和 <span class="arithmatex">\(\psi_T\)</span> 的前 <span class="arithmatex">\(k_\psi\)</span> 阶导数在 <span class="arithmatex">\(t_1, ..., t_{m-1}\)</span> 时刻是连续的。</p>
<hr />
<p>这里 <span class="arithmatex">\(\mu_r\)</span> 和 <span class="arithmatex">\(\mu_\psi\)</span> 简单地理解，就是可供调整的参数。但是这不能解释为什么两者通常具有很明显的大小关系。论文中指出，这两个参数的作用是使得整个积分<strong>无量纲化（nondimensional）</strong>。</p>
<p>详细说来，<span class="arithmatex">\(\left\| \frac{\mathrm{d}^{k_r}\mathbf{r}_T}{\mathrm{d}t^{k_r}} \right\|^2\)</span> 的单位是 <span class="arithmatex">\(m^2 / s^{2k_r}\)</span> ，而 <span class="arithmatex">\(\frac{\mathrm{d}^{k_{\psi}}\psi_{T}}{\mathrm{d}t^{k_\psi}}^2\)</span> 的单位是 <span class="arithmatex">\(\mathrm{rad}^2 / s^{2k_{\psi}}\)</span>，两者单位不统一显然不能直接相加。从这个视角观察 (9) 式，<span class="arithmatex">\(\mu_r\)</span> 的单位就是 <span class="arithmatex">\(s^{2k_r} / m^2\)</span>，而 <span class="arithmatex">\(\mu_{\psi}\)</span> 的单位就是 <span class="arithmatex">\(s^{2k_{\psi}} / \text{rad}^2\)</span> .</p>
<hr />
<p>因为我们的输入项 <span class="arithmatex">\(u_2, u_3\)</span> 中包含位置 <span class="arithmatex">\(\mathbf{r}\)</span> 的四阶导数（snap），所以我们取 <span class="arithmatex">\(k_r = 4\)</span>；
因为我们的输入项 <span class="arithmatex">\(u_4\)</span> 中包含 <span class="arithmatex">\(\psi\)</span> 的二阶导数，所以我们取 <span class="arithmatex">\(k_{\psi} = 2\)</span> 。</p>
<p>当然，我们也可以取得更高一点。</p>
<p>如果我们定义一个尺寸为 <span class="arithmatex">\(4nm\times 1\)</span> 的向量 <span class="arithmatex">\(c = \begin{bmatrix}\sigma_{T11}^T &amp; \sigma_{T12}^T &amp; \cdots &amp; \sigma_{Tnm}^T \end{bmatrix}^T\)</span>，则可将上述问题定义为一个二次规划问题（Quadratic program, QP）</p>
<div class="arithmatex">\[\begin{aligned}
\min \ c^THc &amp;+ f^Tc\\
\text{s.t.}\ \ \ \ \ \  Ac &amp;\le b
\end{aligned}\]</div>
<hr />
<h3 id="53-nondimensionalization">5.3 无量纲化 nondimensionalization</h3>
<p>首先，观察 (11) 式我们可以知道，<span class="arithmatex">\(x_T\)</span>，<span class="arithmatex">\(y_T\)</span>，<span class="arithmatex">\(z_T\)</span> 和 <span class="arithmatex">\(\psi_T\)</span> 都是解耦的（decoupled），所以我们只需要考虑其中的某一项就可以。我们用 <span class="arithmatex">\(\omega\)</span> 来表示这其中一项，用 <span class="arithmatex">\(\omega_i\)</span> 表示 <span class="arithmatex">\(\omega(t_i)\)</span> 。</p>
<p>设 <span class="arithmatex">\(t_0 \le t \le t_m\)</span> 内，<span class="arithmatex">\(\omega_{min} \le \omega(t) \le \omega_{max}\)</span> . 由此，我们可以定义归一化变量</p>
<div class="arithmatex">\[\tau = \frac{t-t_0}{t_m-t_0}\in \left[0, 1\right]\ \ \ \ \ \tilde{\omega}(\tau) = \omega(t) \in \left[\omega_{min}, \omega_{max} \right]\]</div>
<p>则可以将 (11) 式的优化问题写为</p>
<div class="arithmatex">\[\begin{aligned}
\min&amp; \ \ \ \ \ \int_{0}^1 \left(\frac{\mathrm{d}^k\tilde{\omega}(\tau)}{\mathrm{d}\tau^k} \right)^2 \mathrm{d}\tau \\
\text{s.t.}&amp; \ \ \ \ \  \tilde{\omega}(\tau_i) = \tilde{\omega}_i, \ \ \ \ \ i = 0,..., m
\end{aligned} \tag{12}\]</div>
<p>并且设 (12) 式的最优解为 <span class="arithmatex">\(\tilde{\omega}^{*}(t)\)</span> .</p>
<hr />
<blockquote>
<p><strong>TODO：这一整块的意义没有看懂。</strong></p>
</blockquote>
<p>现在我们换一个思路。我们以 (12) 式作为最一般的一个基础式子，看看怎么基于 (12) 式，推导出 <span class="arithmatex">\(x_T\)</span>，<span class="arithmatex">\(y_T\)</span>，<span class="arithmatex">\(z_T\)</span> 和 <span class="arithmatex">\(\psi_T\)</span> 这四个变量的二次规划形式。</p>
<p>论文给了一种比较简单的方式。首先，整体时间肯定得放缩，也就是说整体时间得乘一个比例项，我们不妨取这个比例项为 <span class="arithmatex">\(\alpha\)</span> ，即 <span class="arithmatex">\(t = \alpha \tau\)</span>（这里我们方便起见，假设新的 <span class="arithmatex">\(t_0 = 0\)</span>）；其次，每一个关键帧的值都得偏移，论文这里采用的方式是 <span class="arithmatex">\(\beta_1 + \beta_2 \tilde{\omega}_i\)</span> 。</p>
<blockquote>
<p>一个疑惑：为什么不是每个关键帧单独一个参数，而是整体一套 <span class="arithmatex">\((\beta_1, \beta_2)\)</span> 的参数呢？</p>
</blockquote>
<p>从而，我们得到一个新的 <span class="arithmatex">\(\omega(t)\)</span></p>
<div class="arithmatex">\[\omega(t) = \omega(\alpha \tau) = \beta_1 + \beta_2\tilde{\omega}(\tau)\]</div>
<p>那么，我们有</p>
<div class="arithmatex">\[\begin{aligned}
\frac{\mathrm{d}^k\tilde{\omega}(\tau)}{\mathrm{d}\tau^k} &amp;= \frac{1}{\beta_2}\frac{\mathrm{d}^k(\omega(\alpha\tau)-\beta_1)}{\mathrm{d}\tau^k}\\
&amp;= \frac{1}{\beta_2}\frac{\alpha^k \mathrm{d}(\omega(\alpha\tau))}{\mathrm{d}(\frac{1}{\alpha}t)^k}\\
&amp;= \frac{\alpha^{2k}}{\beta_2}\frac{\mathrm{d}\omega(t)}{\mathrm{d}t^k}\\
\mathrm{d}\tau &amp;= \frac{1}{\alpha}\mathrm{d}t
\end{aligned}\]</div>
<p>代入 (12) 式，可以得到</p>
<div class="arithmatex">\[\begin{aligned}
\min&amp; \ \ \ \ \ \frac{\alpha^{2k-1}}{\beta_2}\int_{0}^\alpha \left(\frac{\mathrm{d}^k\omega(t)}{\mathrm{d}t^k}\right)^2\mathrm{d}t \\
\text{s.t.}&amp; \ \ \ \ \  \omega(t_i) = \beta_1 + \beta_2\tilde\omega_i, \ \ \ \ \ i = 0,..., m
\end{aligned}\tag{13}\]</div>
<p>那么 (13) 式的最优解就是</p>
<div class="arithmatex">\[\omega^{*}(t) = \beta_1 + \beta_2 \tilde{\omega}^{*}(t/\alpha) \tag{14}\]</div>
<p>假设我们已知 (12) 式的最优解，现在我们思考一下其中 <span class="arithmatex">\(\alpha\)</span>，<span class="arithmatex">\(\beta_1\)</span> 和 <span class="arithmatex">\(\beta_2\)</span> 的作用。</p>
<p>论文指出，<span class="arithmatex">\(\alpha\)</span> 是一个时间尺度调整（Temporal Scaling）参数，它能够在保证每个关键帧间的时间段比值一定的情况下，调整总时间长度。<span class="arithmatex">\(\beta_1\)</span> 和 <span class="arithmatex">\(\beta_2\)</span> 是一个空间尺度调整（Spatial scaling）参数，它能够自由调整每个关键帧的值。</p>
<hr />
<h3 id="54-corridor-constraints">5.4 通道限制 corridor constraints</h3>
<p>假定我们要求在关键帧 i 和 i+1 之间，四旋翼必须按照一条近似于直线的轨迹飞过去，我们怎么在二次规划的形式里添加这个约束？</p>
<p>首先，我们需要明确，这个问题和 <span class="arithmatex">\(\psi\)</span> 无关，只和 <span class="arithmatex">\(\mathbf{r}_i\)</span> 以及 <span class="arithmatex">\(\mathbf{r}_{i+1}\)</span>，我们需要对 <span class="arithmatex">\(\mathbf{r}_{T}(t),\ t_i \le t \le t_{i+1}\)</span> 的值进行约束。</p>
<p>我们先定义一个沿着 <span class="arithmatex">\(\mathbf{r}_i\)</span> 到 <span class="arithmatex">\(\mathbf{r}_{i+1}\)</span> 方向的单位向量 <span class="arithmatex">\(\mathbf{t}_i = \frac{\mathbf{r}_{i+1} - \mathbf{r}_{i}}{\left\| \mathbf{r}_{i+1} - \mathbf{r}_{i} \right\|_2}\)</span> ，从而可以得到 <span class="arithmatex">\(\mathbf{r}_T(t)\)</span> 到  <span class="arithmatex">\(\mathbf{r}_i\)</span> 与 <span class="arithmatex">\(\mathbf{r}_{i+1}\)</span> 的连线段的垂线向量：</p>
<div class="arithmatex">\[\mathbf{d}_{i}(t) = (\mathbf{r}_{T}(t) - \mathbf{r}_i) - ((\mathbf{r}_{T}(t) - \mathbf{r}_i)\cdot \mathbf{t}_i)\mathbf{t}_i\]</div>
<p>这里论文选择用 <span class="arithmatex">\(L^\infty\)</span> 范数（各分量绝对值的最大值）来描述这个通道的宽度</p>
<div class="arithmatex">\[\left\| \mathbf{d}_i(t) \right\|_{\infty} = \max\{|d_{i1}|, |d_{i2}|, |d_{i3}||\} \le \delta_i \ \ \text{while} \ \ t_i \le t \le t_{i+1}\]</div>
<p>论文中考虑到这样一个连续的约束在二次规划的实际求解过程中比较困难，因此指出可以仅考虑该时间段中的 <span class="arithmatex">\(n_c\)</span> 个点，<strong>以 <span class="arithmatex">\(\mathbf{x}_W\)</span> 方向为例</strong>：</p>
<div class="arithmatex">\[\left|\mathbf{x}_W \cdot \mathbf{d}_i\left(t_i + \frac{j}{1+n_c}(t_{i+1}-t_i)\right)\right| \le \delta_i \ \ \text{for} \ \ j = 1, ..., n_c\]</div>
<p><span class="arithmatex">\(\mathbf{y}_W\)</span> 方向和 <span class="arithmatex">\(\mathbf{z}_W\)</span> 方向同理。</p>
<hr />
<h3 id="55-optimal-segment-times">5.5 最佳时间分割（Optimal segment times）</h3>
<p>在某些任务中，关键帧的具体抵达时间并没有那么重要，可能不会显式给出、硬性规定；因此，我们可以考虑如何分配每个关键帧之间的运动时间，以实现目标函数最优化。</p>
<p>现在，我们需要换一个角度，不再用抵达时间 <span class="arithmatex">\(t_i\)</span> 看待问题，而是用间隔时间 <span class="arithmatex">\(T_i = t_i - t_{i-1}\)</span> 看待问题，定义一个新的向量 <span class="arithmatex">\(\mathbf{T} = \begin{bmatrix}T_i &amp; T_{i+1} &amp; \cdots &amp; T_{m}\end{bmatrix}\)</span>，则有</p>
<div class="arithmatex">\[\begin{aligned}
\min&amp; \ \ \ \ \ f(\mathbf{T}) \\
\text{s.t.}&amp; \ \ \ \ \  \Sigma T_i = t_m\\&amp; \ \ \ \ \ T_i \ge 0
\end{aligned}\tag{15}\]</div>
<p>怎么解这个优化式子呢？论文给出的一种方案是梯度下降法（gradient descent method），用到了回溯直线搜索（backtracking line search）。</p>
<p>首先是<strong>梯度下降法</strong>。我们先确定一个 <span class="arithmatex">\(\mathbf{T}\)</span> 的初值，然后以此出发点进行搜索。怎么搜索呢？直观的想法就是每个“方向”我都去看一看，综合判断一下哪个方向最好。所以我们定义一组方向变量 <span class="arithmatex">\(g_i\)</span>，满足第 i 个分量是 1，其它所有分量都是 <span class="arithmatex">\(\frac{-1}{m-1}\)</span> 。为什么要这么做？因为这样就能保证，<span class="arithmatex">\(\mathbf{T} + g_i\)</span> 后，仍然能够保证各个时间段求和得到的总时间为 <span class="arithmatex">\(t_m\)</span> 。</p>
<blockquote>
<p>上文说的“方向”是用几何的视角来看待这个多维变量。实际上，“往哪个方向走”在这里指的是“给哪一段过程多匀点时间出来”。</p>
</blockquote>
<p>通过如下方式，以数值计算的方法求 <span class="arithmatex">\(\mathbf{g}_i\)</span> 方向上的梯度：</p>
<div class="arithmatex">\[\nabla_{g_i}f = \frac{f(\mathbf{T}+h\mathbf{g}_i) - f(\mathbf{T})}{h}\]</div>
<p>这里的 <span class="arithmatex">\(h\)</span> 是一个相当小的值。</p>
<p>而我们要求的“方向”就是使梯度最小的 <span class="arithmatex">\(\mathbf{g}_i\)</span> 方向</p>
<div class="arithmatex">\[\mathbf{d} = arg \min_{\mathbf{g}_i} (\nabla_{\mathbf{g}_i}f)\]</div>
<p>这里请注意，我们想要的是使 <span class="arithmatex">\(\nabla_{g_i}f &lt; 0\)</span> 的方向，倘若 <span class="arithmatex">\(\nabla_{g_i}f\)</span> 全都大于等于 0，那么我们也就已经找到了局部极值点。</p>
<blockquote>
<p>这里和传统的梯度下降法还不一样。传统的梯度下降法是直接算个梯度出来，也就是 <span class="arithmatex">\(\mathbf{d} = -\nabla f = -\begin{bmatrix}\nabla_1 f &amp; \nabla_2 f &amp; \cdots &amp; \nabla_m f\end{bmatrix}\)</span>，其中，<span class="arithmatex">\(\nabla_i f = \lim_{h\to 0}\frac{f(\mathbf{T} + h  \mathbf{e}_i) - f(\mathbf{T})}{h}\)</span> 。而论文此处考虑到总时间不变的约束，采用了简化的梯度下降方式。</p>
</blockquote>
<p>找到了“方向”之后，我们向这个方向走一步，也就是从 <span class="arithmatex">\(\mathbf{T}\)</span> 走到 <span class="arithmatex">\(\mathbf{T} + \alpha \mathbf{d}\)</span> 的位置，这里的 <span class="arithmatex">\(\alpha\)</span> 就是我们这一步的长度，即步长。这 <span class="arithmatex">\(\alpha\)</span> 不能太大，否则会在局部极值点附近来回振荡；也不能太小，否则一步步挪过去太慢了。</p>
<hr />
<p>我们用<strong>回溯直线搜索</strong>的方法来判断步长是否合适。</p>
<p>具体说来，我们用 Armijo 条件来判断：</p>
<div class="arithmatex">\[f(\mathbf{T} + \alpha \mathbf{d}) \le f(\mathbf{T}) + c\cdot \nabla_{\mathbf{d}}f \cdot(\alpha \mathbf{d})\]</div>
<p>这里的 <span class="arithmatex">\(c\)</span> 是一个控制参数，一般来说取得比较小，比如说 <span class="arithmatex">\(10^{-4}\)</span>，也就是说，不等号右边的这条线，斜率基本上是平的。</p>
<p>如果计算结果不满足这个 Armijo 条件，我们就需要更新步长：</p>
<div class="arithmatex">\[\alpha' = \beta\alpha\]</div>
<p>这里的 <span class="arithmatex">\(\beta \in (0, 1)\)</span>，是一个缩放常数。</p>
<p>什么时候停止搜寻呢？最好情况当然是 <span class="arithmatex">\(\nabla_{g_i}f\)</span> 全都大于等于 0，但如果迟迟做不到这一点，我们也没必要一直减小步长一直搜索。我们可以给步长设定一个下限值，当步长小于该下限值时，我们可以近似认为找到了一个局部极值点。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2025 Cloudmosquito
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-chtml-full.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>